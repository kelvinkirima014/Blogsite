<!DOCTYPE html>
<html>
    <head>

        <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="color-scheme" content=" dark light ">
		<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme:light)">
		<meta name="theme-color" content="#000000" media="(prefers-color-scheme:dark)">

		<meta property="og:site_name" content="Kelvin Kirima">

        <title> Kelvin Kirima </title>
		<meta property="og:title" content="">
		<meta name="description" content="This tutorial will take you from zero to one in building on the Solana network. I’ll guide you through the entire process of developing on Solana by building an on-chain program using Rust and deploying it to the Solana test net. We’ll also interact with the on-chain program using the Solana/web3js Javascript API.">
		<meta property="og:type" content="article">

        <link rel="stylesheet" href="posts.css">

    </head>
    <body>
        <header>
             <a href="/index.html" class="home-link">Kirima</a>
        </header>
        
        <h1></h1>
        <div class="outline"></div>
        <div class="blog-container">
            <h2>A Gentle Introduction to Solana</h2><p>This tutorial will take you from <em>zero to one</em> in building on the <a href='https://solana.com/'>Solana network</a>. I’ll guide you through the entire process of developing on Solana by building an on-chain program using Rust and deploying it to the Solana test net. We’ll also interact with the on-chain program using the Solana/web3js Javascript API.</p><p>You don’t have to be familiar with Rust to learn from this tutorial. I’ll walk you through various Rust concepts that are necessary to understand the code and also point you to the best resources.</p><h3>Prerequisites</h3><ul><li>Basic familiarity with a <a href='https://en.wikipedia.org/wiki/Command-line_interface'>command-line interface</a></li><li>Basic programming knowledge in any language.</li></ul><h3>Requirements.</h3><p>You’ll need the following installed before we proceed:</p><ul><li><a href='https://nodejs.org/en/download/'>node</a> version 14+</li><li>git</li><li>Github account</li><li>Rust - install <a href='https://www.rust-lang.org/tools/install#:~:text=To%20start%20using%20Rust%2C%20download,see%20%22Other%20Installation%20Methods%22.'>from here</a>, it’s pretty straightforward.</li><li>Solana tool suite - follow <a href='https://docs.solana.com/cli/install-solana-cli-tools'>this simple guide</a> to install. </li></ul><h3>Programming on Solana - Something you should know.</h3><p>Before we start coding our program, we must have an overview of what’s building on Solana is like. Unlike other blockchains, in Solana, smart contracts are called Programs. Solana programs are compiled to a variation of bytecode known as <a href='https://ebpf.io/what-is-ebpf/'>Berkley Packet Filter (BPF)</a>. Solana uses BPF  because it allows <a href='https://ebpf.io/what-is-ebpf/#jit-compilation'>just-in-time(JIT)</a> compilation which is great for performance. </p><p>When called, a program must be passed to something called a <a href='https://docs.solana.com/developing/on-chain-programs/overview#loaders'>BPF loader</a> which is responsible for loading and executing BPF programs. All programs export an entrypoint that the runtime looks up and calls when invoking a program.</p><p>Because programs are written to target the BPF loader, they can be written in any language that compiles to BPF bytecode. Solana currently supports writing programs in Rust and C/C++.</p><h3>Our Solana program.</h3><p>Solana has a nice <a href='https://github.com/solana-labs/example-helloworld'>hello-world example</a> that shows us how to build a Rust program on Solana from scratch and interact with it using a typescript SDK. </p><p>The example comprises of:</p><ul><li>An on-chain hello world program</li><li>A client that can send a “hello” to an account and get back the number of times “hello” has been sent.</li></ul><p>We’ll leverage this example to learn how to build our programs. Open your CLI and run the following command to clone the repo.</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">git</span></span><span class="smeta sfunction-call sarguments sshell"> clone https://github.com/solana-labs/example-helloworld.git</span>
</span></code></pre><p>then:</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="ssupport sfunction scd sshell">cd</span></span><span class="smeta sfunction-call sarguments sshell"> example-helloworld</span>
</span></code></pre><p>open the project in your IDE. In the src folder, you’ll find two ways to build the program. One uses the C language while the other uses Rust. Since we are building with Rust, go ahead and open the program-rust folder and ignore program-c. There is also a client folder but we’ll get to it later. For now, we are interested in <code class ='scode'>lib.rs</code> inside the program-rust <code class ='scode'>src</code>. The code looks like this:</p><pre class='scode'><code><span class="ssource srust"><span class="skeyword sother srust">use</span> <span class="smeta spath srust">borsh<span class="spunctuation saccessor srust">::</span></span><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>BorshDeserialize<span class="spunctuation sseparator srust">,</span> BorshSerialize</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span><span class="spunctuation sterminator srust">;</span>
<span class="skeyword sother srust">use</span> <span class="smeta spath srust">solana_program<span class="spunctuation saccessor srust">::</span></span><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
    <span class="smeta spath srust">account_info<span class="spunctuation saccessor srust">::</span></span><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>next_account_info<span class="spunctuation sseparator srust">,</span> AccountInfo</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span><span class="spunctuation sseparator srust">,</span>
    entrypoint<span class="spunctuation sseparator srust">,</span>
    <span class="smeta spath srust">entrypoint<span class="spunctuation saccessor srust">::</span></span>ProgramResult<span class="spunctuation sseparator srust">,</span>
    msg<span class="spunctuation sseparator srust">,</span>
    <span class="smeta spath srust">program_error<span class="spunctuation saccessor srust">::</span></span>ProgramError<span class="spunctuation sseparator srust">,</span>
    <span class="smeta spath srust">pubkey<span class="spunctuation saccessor srust">::</span></span>Pubkey<span class="spunctuation sseparator srust">,</span>
</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span><span class="spunctuation sterminator srust">;</span>

<span class="scomment sline sdocumentation srust"><span class="spunctuation sdefinition scomment srust">///</span> Define the type of state stored in accounts
</span><span class="smeta sannotation srust"><span class="spunctuation sdefinition sannotation srust">#</span><span class="spunctuation ssection sgroup sbegin srust">[</span><span class="svariable sannotation srust">derive</span><span class="smeta sannotation sparameters srust"><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span></span><span class="smeta sannotation sparameters srust"><span class="smeta sgroup srust">BorshSerialize<span class="spunctuation sseparator srust">,</span> BorshDeserialize<span class="spunctuation sseparator srust">,</span> Debug</span></span><span class="smeta sannotation sparameters srust"><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span></span><span class="spunctuation ssection sgroup send srust">]</span></span>
<span class="smeta sstruct srust"><span class="sstorage smodifier srust">pub</span> <span class="sstorage stype sstruct srust">struct</span> </span><span class="smeta sstruct srust"><span class="sentity sname sstruct srust">GreetingAccount</span> </span><span class="smeta sstruct srust"><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
    <span class="scomment sline sdocumentation srust"><span class="spunctuation sdefinition scomment srust">///</span> number of greetings
</span>    <span class="sstorage smodifier srust">pub</span> <span class="svariable sother smember srust">counter</span><span class="spunctuation sseparator srust">:</span> <span class="sstorage stype srust">u32</span>,
</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span></span>

<span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Declare and export the program&#39;s entrypoint
</span><span class="ssupport smacro srust">entrypoint!</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span>process_instruction</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>

<span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Program entrypoint&#39;s implementation
</span><span class="smeta sfunction srust"><span class="smeta sfunction srust"><span class="sstorage smodifier srust">pub</span> <span class="sstorage stype sfunction srust">fn</span> </span><span class="sentity sname sfunction srust">process_instruction</span></span><span class="smeta sfunction srust"><span class="smeta sfunction sparameters srust"><span class="spunctuation ssection sparameters sbegin srust">(</span>
    <span class="svariable sparameter srust">program_id</span><span class="spunctuation sseparator srust">:</span> <span class="skeyword soperator srust">&amp;</span>Pubkey, <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Public key of the account the hello world program was loaded into
</span>    <span class="svariable sparameter srust">accounts</span><span class="spunctuation sseparator srust">:</span> <span class="skeyword soperator srust">&amp;</span>[AccountInfo], <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> The account to say hello to
</span>    <span class="svariable sparameter srust">_instruction_data</span><span class="spunctuation sseparator srust">:</span> <span class="skeyword soperator srust">&amp;</span>[<span class="sstorage stype srust">u8</span>], <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Ignored, all helloworld instructions are hellos
</span></span><span class="smeta sfunction srust"><span class="smeta sfunction sparameters srust"><span class="spunctuation ssection sparameters send srust">)</span></span></span></span><span class="smeta sfunction srust"> <span class="smeta sfunction sreturn-type srust"><span class="spunctuation sseparator srust">-&gt;</span> ProgramResult</span> </span><span class="smeta sfunction srust"><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
    <span class="ssupport smacro srust">msg!</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>Hello World Rust program entrypoint<span class="spunctuation sdefinition sstring send srust">&quot;</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>

    <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Iterate over accounts
</span>    <span class="sstorage stype srust">let</span> accounts_iter <span class="skeyword soperator srust">=</span> <span class="skeyword soperator srust">&amp;</span><span class="sstorage smodifier srust">mut</span> accounts.<span class="ssupport sfunction srust">iter</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>

    <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Get the account to say hello to
</span>    <span class="sstorage stype srust">let</span> account <span class="skeyword soperator srust">=</span> <span class="ssupport sfunction srust">next_account_info</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span>accounts_iter</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="skeyword soperator srust">?</span><span class="spunctuation sterminator srust">;</span>

    <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> The account must be owned by the program in order to modify its data
</span>    <span class="skeyword scontrol srust">if</span> account.owner <span class="skeyword soperator srust">!</span><span class="skeyword soperator srust">=</span> program_id <span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
        <span class="ssupport smacro srust">msg!</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>Greeted account does not have the correct program id<span class="spunctuation sdefinition sstring send srust">&quot;</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>
        <span class="skeyword scontrol srust">return</span> <span class="ssupport stype srust">Err</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="smeta spath srust">ProgramError<span class="spunctuation saccessor srust">::</span></span>IncorrectProgramId</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>
    </span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span>

    <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Increment and store the number of times the account has been greeted
</span>    <span class="sstorage stype srust">let</span> <span class="sstorage smodifier srust">mut</span> greeting_account <span class="skeyword soperator srust">=</span> <span class="smeta spath srust">GreetingAccount<span class="spunctuation saccessor srust">::</span></span>try_from_slice<span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="skeyword soperator srust">&amp;</span>account.data.<span class="ssupport sfunction srust">borrow</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="skeyword soperator srust">?</span><span class="spunctuation sterminator srust">;</span>
    greeting_account.counter <span class="skeyword soperator srust">+</span><span class="skeyword soperator srust">=</span> <span class="sconstant snumeric sinteger sdecimal srust">1</span><span class="spunctuation sterminator srust">;</span>
    greeting_account.<span class="ssupport sfunction srust">serialize</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="skeyword soperator srust">&amp;</span><span class="sstorage smodifier srust">mut</span> <span class="skeyword soperator srust">&amp;</span><span class="sstorage smodifier srust">mut</span> account.data.<span class="ssupport sfunction srust">borrow_mut</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">[</span><span class="skeyword soperator srust">..</span><span class="spunctuation ssection sgroup send srust">]</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="skeyword soperator srust">?</span><span class="spunctuation sterminator srust">;</span>

    <span class="ssupport smacro srust">msg!</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>Greeted {} time(s)!<span class="spunctuation sdefinition sstring send srust">&quot;</span></span><span class="spunctuation sseparator srust">,</span> greeting_account.counter</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>

    <span class="ssupport stype srust">Ok</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span>
</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span></span>
<span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span>Minus the tests.
</span></span></code></pre><p>There’s a lot of awesome things going on in the above code. Let’s go through it line by line, as I promised. </p><p>Rust allows us to build on code written by others using <a href='https://learning-rust.github.io/docs/d4.crates.html'>crates</a>. A crate can contain several modules and we specify the modules we want to bring into scope. First, we bring the crates we need via a <em>use</em> declaration.  This is our first use declaration:</p><pre class='scode'><code><span class="ssource srust"><span class="skeyword sother srust">use</span> <span class="smeta spath srust">borsh<span class="spunctuation saccessor srust">::</span></span><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>BorshDeserialize<span class="spunctuation sseparator srust">,</span> BorshSerialize</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span><span class="spunctuation sterminator srust">;</span>
</span></code></pre><p>We specify we’ll need  <code class ='scode'>BorshDeserialize</code> **and <code class ='scode'>BorshSerialize</code> from the crate <code class ='scode'>borsh</code>  The double colon<code class ='scode'>::</code>   is the path separator. Borsh is a binary serialization format. It is designed to serialize any objects to canonical and deterministic set of bytes.  <code class ='scode'>BorsheSerialize</code> is used for converting data(structs, ints, enums, etc) into bytecode while <code class ='scode'>BorsheDeserialize</code> reconstructs the bytecode into data. Serializing is necessary because the programs must be parsed in BPF format.</p><p>The next <code class ='scode'>use</code> declaration brings the <code class ='scode'>solana_program</code> crate into the scope. This crate contains a bunch of Solana source code that we’ll leverage to write on-chain programs.</p><pre class='scode'><code><span class="ssource srust"><span class="skeyword sother srust">use</span> <span class="smeta spath srust">solana_program<span class="spunctuation saccessor srust">::</span></span><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
    <span class="smeta spath srust">account_info<span class="spunctuation saccessor srust">::</span></span><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>next_account_info<span class="spunctuation sseparator srust">,</span> AccountInfo</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span><span class="spunctuation sseparator srust">,</span>
    entrypoint<span class="spunctuation sseparator srust">,</span>
    <span class="smeta spath srust">entrypoint<span class="spunctuation saccessor srust">::</span></span>ProgramResult<span class="spunctuation sseparator srust">,</span>
    msg<span class="spunctuation sseparator srust">,</span>
    <span class="smeta spath srust">program_error<span class="spunctuation saccessor srust">::</span></span>ProgramError<span class="spunctuation sseparator srust">,</span>
    <span class="smeta spath srust">pubkey<span class="spunctuation saccessor srust">::</span></span>Pubkey<span class="spunctuation sseparator srust">,</span>
</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span><span class="spunctuation sterminator srust">;</span>
</span></code></pre><p>Let’s discuss what each item we brought from the <code class ='scode'>solana_program</code> crate does:</p><ul><li>from <em>account_info</em> we get <a href='https://github.com/solana-labs/solana/blob/a911ae00baa9bb7031041add14c5185c86376afb/sdk/program/src/account_info.rs#L202'><code class ='scode'>next_account_info</code></a> which is a public function that returns the next <code class ='scode'>AccountInfo</code> or a <code class ='scode'>NotEnoughAccountKeys</code> error. <code class ='scode'>AccountInfo</code> is a public struct(we’ll discuss structs in a few) that contains the account’s information - like the Pubkey and owner. You can view the source code <a href='https://github.com/solana-labs/solana/blob/a911ae00baa9bb7031041add14c5185c86376afb/sdk/program/src/account_info.rs#L10'>here</a>.</li><li>In <code class ='scode'>entrypoint</code>, we have an <code class ='scode'>entrypoint!</code> <a href='https://doc.rust-lang.org/rust-by-example/macros.html'>macro</a> that we’ll later use to call our program. Macros are a way of writing code that writes other code. They reduce the amount of code you need to write! We have different forms of macros, the <em>entrypoint</em> we just brought into scope is known as a <a href='https://doc.rust-lang.org/reference/macros-by-example.html'>declarative macro</a> because it allows us to define syntax extension in a declarative way.</li><li>We then bring <code class ='scode'>ProgramResult</code> which also lives in the <a href='https://github.com/solana-labs/solana/blob/a911ae00baa9bb7031041add14c5185c86376afb/sdk/program/src/entrypoint.rs#L18'>same file</a> as the entrypoint macro. It’s a <a href='https://doc.rust-lang.org/stable/book/ch09-02-recoverable-errors-with-result.html?highlight=resu#recoverable-errors-with-result'>Result</a> type that returns <code class ='scode'>Ok</code> if the program runs well or <code class ='scode'>ProgramError</code> if the program fails. <a href='https://doc.rust-lang.org/stable/book/ch09-02-recoverable-errors-with-result.html?highlight=resu#recoverable-errors-with-result'>Result</a> is an enum in Rust which is defined as having two variants, <code class ='scode'>Ok</code> and <code class ='scode'>Err</code>. We use it for error handling.</li><li><code class ='scode'>msg</code> is a macro that’s used for logging in Solana. If you have programmed in Rust before, you may be used to the <code class ='scode'>println!</code> macro but Solana considers it computationally expensive.</li><li><code class ='scode'>ProgramError</code> allows you to implement program-specific error types and see them returned by the Solana runtime.</li><li>Lastly, we bring in the <a href='https://github.com/solana-labs/solana/blob/a911ae00baa9bb7031041add14c5185c86376afb/sdk/program/src/pubkey.rs#L57'><code class ='scode'>Pubkey</code></a> struct from <code class ='scode'>pubkey</code>. We’ll use it to pass the public keys of our accounts.</li></ul><p>One more thing I would like you to note is that whenever we bring a crate, we must also specify so in cargo.toml like so</p><pre class='scode'><code><span class="ssource srust"><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">[</span>dependencies<span class="spunctuation ssection sgroup send srust">]</span></span>
borsh <span class="skeyword soperator srust">=</span> <span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>0.9.1<span class="spunctuation sdefinition sstring send srust">&quot;</span></span>
borsh<span class="skeyword soperator srust">-</span>derive <span class="skeyword soperator srust">=</span> <span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>0.9.1<span class="spunctuation sdefinition sstring send srust">&quot;</span></span>
solana<span class="skeyword soperator srust">-</span>program <span class="skeyword soperator srust">=</span> <span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>1.7.9<span class="spunctuation sdefinition sstring send srust">&quot;</span></span>
</span></code></pre><p><a href='https://doc.rust-lang.org/stable/book/ch01-03-hello-cargo.html'>Cargo</a> is Rust’s package manager, like npm in JS. In that line of thought, cargo.toml is analogous to package.json.</p><p>After the use declarations, here is what we have next.</p><pre class='scode'><code><span class="ssource srust"><span class="smeta sannotation srust"><span class="spunctuation sdefinition sannotation srust">#</span><span class="spunctuation ssection sgroup sbegin srust">[</span><span class="svariable sannotation srust">derive</span><span class="smeta sannotation sparameters srust"><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span></span><span class="smeta sannotation sparameters srust"><span class="smeta sgroup srust">BorshSerialize<span class="spunctuation sseparator srust">,</span> BorshDeserialize<span class="spunctuation sseparator srust">,</span> Debug</span></span><span class="smeta sannotation sparameters srust"><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span></span><span class="spunctuation ssection sgroup send srust">]</span></span>
<span class="smeta sstruct srust"><span class="sstorage smodifier srust">pub</span> <span class="sstorage stype sstruct srust">struct</span> </span><span class="smeta sstruct srust"><span class="sentity sname sstruct srust">GreetingAccount</span> </span><span class="smeta sstruct srust"><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
    <span class="scomment sline sdocumentation srust"><span class="spunctuation sdefinition scomment srust">///</span> number of greetings
</span>    <span class="sstorage smodifier srust">pub</span> <span class="svariable sother smember srust">counter</span><span class="spunctuation sseparator srust">:</span> <span class="sstorage stype srust">u32</span>,
</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span></span>
</span></code></pre><p><code class ='scode'>#[derive]</code> belongs to another group of macros known as procedural macros. Deriving tells the compiler to provide some basic implementations for some traits. Besides the serialize and deserializing traits, we also derive the <code class ='scode'>Debug</code> trait. In Rust, traits allow us to share behaviour across non-abstract types like structs and facilitates code reuse. They are like interfaces in other languages. <code class ='scode'>Debug</code> trait makes types like structs and enums printable. </p><p>Next, we declare the <code class ='scode'>GreetingAccount</code> <em>struct</em> using the <code class ='scode'>pub</code> keyword which makes it <em>publicly</em> accessible so other programs can use it. By default, everything in Rust is private, with two exceptions: Associated items in a pub Trait and Enum variants in a pub enum. A <code class ='scode'>struct</code> or structure is a custom data type that allows us to package related values. Each field defined within a struct has a name and a type. <code class ='scode'>GreetingAccount</code> has only one field: <code class ='scode'>counter</code> with a type of <code class ='scode'>u32</code>, an unsigned(positive) 32-bit integer.</p><h3>program entrypoint.</h3><p>All Solana programs must have an <code class ='scode'>entrypoint</code> that the runtime looks up and calls when invoking a program. The <a href='https://github.com/solana-labs/solana/blob/a911ae00baa9bb7031041add14c5185c86376afb/sdk/program/src/entrypoint.rs#L42'><code class ='scode'>entrypoint!</code></a> macro declares <code class ='scode'>process_instruction</code> as the entry to our program. An instruction specifies which program it is calling, which accounts it wants to read or modify, and additional data. </p><pre class='scode'><code><span class="ssource srust"><span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Declare and export the program&#39;s entrypoint
</span><span class="ssupport smacro srust">entrypoint!</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span>process_instruction</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>

</span></code></pre><p>We implement <code class ='scode'>process_instruction</code>via a function with visibility set to public.</p><pre class='scode'><code><span class="ssource srust"><span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Program entrypoint&#39;s implementation
</span><span class="smeta sfunction srust"><span class="smeta sfunction srust"><span class="sstorage smodifier srust">pub</span> <span class="sstorage stype sfunction srust">fn</span> </span><span class="sentity sname sfunction srust">process_instruction</span></span><span class="smeta sfunction srust"><span class="smeta sfunction sparameters srust"><span class="spunctuation ssection sparameters sbegin srust">(</span>
    <span class="svariable sparameter srust">program_id</span><span class="spunctuation sseparator srust">:</span> <span class="skeyword soperator srust">&amp;</span>Pubkey, <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Public key of the account the hello world program was loaded into
</span>    <span class="svariable sparameter srust">accounts</span><span class="spunctuation sseparator srust">:</span> <span class="skeyword soperator srust">&amp;</span>[AccountInfo], <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> The account to say hello to
</span>    <span class="svariable sparameter srust">_instruction_data</span><span class="spunctuation sseparator srust">:</span> <span class="skeyword soperator srust">&amp;</span>[<span class="sstorage stype srust">u8</span>], <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Ignored, all helloworld instructions are hellos
</span></span><span class="smeta sfunction srust"><span class="smeta sfunction sparameters srust"><span class="spunctuation ssection sparameters send srust">)</span></span></span></span><span class="smeta sfunction srust"> <span class="smeta sfunction sreturn-type srust"><span class="spunctuation sseparator srust">-&gt;</span> ProgramResult</span> </span><span class="smeta sfunction srust"><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
<span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span>snip
</span></span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span></span>
</span></code></pre><p>You may have noticed that each parameter has an ampersand operator <code class ='scode'>&amp;</code>. This is because  Solana programs do not store data, data is stored in accounts. The ampersand tells Rust that we do not own this data, we’re just borrowing it, we call this <a href='https://learning-rust.github.io/docs/c2.borrowing.html'>referencing</a>.</p><ul><li><code class ='scode'>program_id</code> is the public key of the currently executing program accounts. When you want to call a program, you must also pass this id, so that Solana knows which program is to be executed. </li><li><code class ='scode'>accounts</code> is a reference to an array of accounts to say hello to. It is the list of accounts that will be operated upon in this code.</li><li><code class ='scode'>_instruction_data</code> - any additional data passed as a u8 array. In this program, we won’t be consuming this data because it’s just hellos, so we add the _underscore to tell the compiler to chill.</li></ul><pre class='scode'><code><span class="ssource srust"><span class="smeta sfunction srust"><span class="smeta sfunction srust"><span class="sstorage smodifier srust">pub</span> <span class="sstorage stype sfunction srust">fn</span> </span><span class="sentity sname sfunction srust">process_instruction</span></span><span class="smeta sfunction srust"><span class="smeta sfunction sparameters srust"><span class="spunctuation ssection sparameters sbegin srust">(</span>
    <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span>params
</span></span><span class="smeta sfunction srust"><span class="smeta sfunction sparameters srust"><span class="spunctuation ssection sparameters send srust">)</span></span></span></span><span class="smeta sfunction srust"> <span class="smeta sfunction sreturn-type srust"><span class="spunctuation sseparator srust">-&gt;</span> ProgramResult</span> </span><span class="smeta sfunction srust"><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
    <span class="ssupport smacro srust">msg!</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>Hello World Rust program entrypoint<span class="spunctuation sdefinition sstring send srust">&quot;</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>

    <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Iterating accounts is safer then indexing
</span>    <span class="sstorage stype srust">let</span> accounts_iter <span class="skeyword soperator srust">=</span> <span class="skeyword soperator srust">&amp;</span><span class="sstorage smodifier srust">mut</span> accounts.<span class="ssupport sfunction srust">iter</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>

    <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Get the account to say hello to
</span>    <span class="sstorage stype srust">let</span> account <span class="skeyword soperator srust">=</span> <span class="ssupport sfunction srust">next_account_info</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span>accounts_iter</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="skeyword soperator srust">?</span><span class="spunctuation sterminator srust">;</span>

    <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> snip
</span></span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span></span>
</span></code></pre><p>The function returns <code class ='scode'>ProgramResult</code> which we imported earlier. ProgramResult is of Result type which is an Enum with two variants: Ok representing success and containing a value, and Err representing error and containing an error value. ProgramResult will give as an Ok() as a success if our <em>instruction</em> is processed or a ProgramError if it fails.</p><p>We use the <a href='https://docs.solana.com/developing/on-chain-programs/developing-rust#logging'>msg!</a> macro for printing messages on the program log.</p><p>We create a new variable <code class ='scode'>accounts_iter</code> using the let keyword. We <a href='https://doc.rust-lang.org/stable/book/ch13-02-iterators.html?highlight=ite#processing-a-series-of-items-with-iterators'>iterate</a> over each account using the <code class ='scode'>iter()</code> method and bind them to the variable as <em>mutable references</em>. Rust <a href='https://learning-rust.github.io/docs/c2.borrowing.html'>references</a> are immutable by default so we have to specify that we want to be able to write to each account by adding the <code class ='scode'>mut</code> keyword. As I mentioned, <code class ='scode'>next_account_info</code> will return the account we want to say hello to or an error if it doesn’t find an account. It’s able to do this because the function returns the <code class ='scode'>Result</code> type we talked of earlier. The <a href='https://doc.rust-lang.org/std/result/#the-question-mark-operator-'>question mark operator</a> <code class ='scode'>?</code> hides some of the boilerplate of propagating errors.</p><p>Only the program that owns the account should be able to modify its data. This check ensures that if the <code class ='scode'>account.owner</code> public key does not equal the <code class ='scode'>program_id</code> we will return an <code class ='scode'>IncorrectProgramId</code> error.</p><pre class='scode'><code><span class="ssource srust"><span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> The account must be owned by the program in order to modify its data
</span>    <span class="skeyword scontrol srust">if</span> account.owner <span class="skeyword soperator srust">!</span><span class="skeyword soperator srust">=</span> program_id <span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
        <span class="ssupport smacro srust">msg!</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>Greeted account does not have the correct program id<span class="spunctuation sdefinition sstring send srust">&quot;</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>
        <span class="skeyword scontrol srust">return</span> <span class="ssupport stype srust">Err</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="smeta spath srust">ProgramError<span class="spunctuation saccessor srust">::</span></span>IncorrectProgramId</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>
    </span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span>

</span></code></pre><p>Lastly, here’s what we have…</p><pre class='scode'><code><span class="ssource srust">   <span class="scomment sline sdouble-slash srust"><span class="spunctuation sdefinition scomment srust">//</span> Increment and store the number of times the account has been greeted
</span>    <span class="sstorage stype srust">let</span> <span class="sstorage smodifier srust">mut</span> greeting_account <span class="skeyword soperator srust">=</span> <span class="smeta spath srust">GreetingAccount<span class="spunctuation saccessor srust">::</span></span>try_from_slice<span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="skeyword soperator srust">&amp;</span>account.data.<span class="ssupport sfunction srust">borrow</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="skeyword soperator srust">?</span><span class="spunctuation sterminator srust">;</span>
    greeting_account.counter <span class="skeyword soperator srust">+</span><span class="skeyword soperator srust">=</span> <span class="sconstant snumeric sinteger sdecimal srust">1</span><span class="spunctuation sterminator srust">;</span>
    greeting_account.<span class="ssupport sfunction srust">serialize</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="skeyword soperator srust">&amp;</span><span class="sstorage smodifier srust">mut</span> <span class="skeyword soperator srust">&amp;</span><span class="sstorage smodifier srust">mut</span> account.data.<span class="ssupport sfunction srust">borrow_mut</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">[</span><span class="skeyword soperator srust">..</span><span class="spunctuation ssection sgroup send srust">]</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="skeyword soperator srust">?</span><span class="spunctuation sterminator srust">;</span>

    <span class="ssupport smacro srust">msg!</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="sstring squoted sdouble srust"><span class="spunctuation sdefinition sstring sbegin srust">&quot;</span>Greeted {} time(s)!<span class="spunctuation sdefinition sstring send srust">&quot;</span></span><span class="spunctuation sseparator srust">,</span> greeting_account.counter</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span><span class="spunctuation sterminator srust">;</span>

    <span class="ssupport stype srust">Ok</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup sbegin srust">(</span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span></span><span class="smeta sgroup srust"><span class="spunctuation ssection sgroup send srust">)</span></span>
</span></code></pre><p>Rust variables are immutable by default, even when declared with the <code class ='scode'>let</code> keyword. Therefore, to create a variable that we’ll modify, we have to add the mut keyword, just like we did with references. try_from_slice() is a method from the borsh crate that we use to deserialize an instance from slice of bytes to actual data our program can work with. Under the hood, it looks like this:</p><pre class='scode'><code><span class="ssource srust"><span class="smeta sfunction srust"><span class="smeta sfunction srust"><span class="sstorage stype sfunction srust">fn</span> </span><span class="sentity sname sfunction srust">try_from_slice</span></span><span class="smeta sfunction srust"><span class="smeta sfunction sparameters srust"><span class="spunctuation ssection sparameters sbegin srust">(</span><span class="svariable sparameter srust">v</span><span class="spunctuation sseparator srust">:</span> <span class="skeyword soperator srust">&amp;</span>[<span class="sstorage stype srust">u8</span>]</span><span class="smeta sfunction srust"><span class="smeta sfunction sparameters srust"><span class="spunctuation ssection sparameters send srust">)</span></span></span></span><span class="smeta sfunction srust"> <span class="smeta sfunction sreturn-type srust"><span class="spunctuation sseparator srust">-&gt;</span> <span class="smeta sgeneric srust">Result<span class="spunctuation sdefinition sgeneric sbegin srust">&lt;</span><span class="sstorage stype srust">Self</span><span class="spunctuation sdefinition sgeneric send srust">&gt;</span></span>
</span></span></span></code></pre><p>try_from_slice could also return an error if the deserialization fails - note the <code class ='scode'>?</code> operator because it implements the <em>Result</em> type. We use the actual account data we borrowed to get the counter value and increment it by one and send it back to the runtime in serialized format. We then print in the Program Log how many times the count has been incremented by using the msg!() macro.</p><h3>Configuring Solana CLI</h3><p>First make sure you have solana installed: </p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana</span></span><span class="smeta sfunction-call sarguments sshell"><span class="svariable sparameter soption sshell"><span class="spunctuation sdefinition sparameter sshell"> --</span>version</span></span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana-cli</span></span><span class="smeta sfunction-call sarguments sshell"> 1.7.11 (src:bdb77b0c</span><span class="skeyword soperator slogical scontinue sshell">;</span> <span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">feat:1140394761</span></span><span class="smeta sfunction-call sshell"></span><span class="smeta spost-cmd sshell">)</span>
</span></code></pre><p>In Solana, a set of validators make up a cluster. We’ve three clusters: mainnet, devnet and localhost. For our purposes, we’ll use the local cluster. Let’s set the CLI config to the localhost cluster using the <em>config set</em> command.</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana</span></span><span class="smeta sfunction-call sarguments sshell"> config set<span class="svariable sparameter soption sshell"><span class="spunctuation sdefinition sparameter sshell"> --</span>url</span> localhost</span>
</span></code></pre><p>The output should resemble this..</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana</span></span><span class="smeta sfunction-call sarguments sshell"> config set<span class="svariable sparameter soption sshell"><span class="spunctuation sdefinition sparameter sshell"> --</span>url</span> localhost</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Config</span></span><span class="smeta sfunction-call sarguments sshell"> File: /home/kelvin/.config/solana/cli/config.yml</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">RPC</span></span><span class="smeta sfunction-call sarguments sshell"> URL: http://localhost:8899 </span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">WebSocket</span></span><span class="smeta sfunction-call sarguments sshell"> URL: ws://localhost:8900/ (computed</span><span class="smeta sfunction-call sshell"></span><span class="smeta spost-cmd sshell">)</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Keypair</span></span><span class="smeta sfunction-call sarguments sshell"> Path: /home/kelvin/.config/solana/id.json </span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Commitment:</span></span><span class="smeta sfunction-call sarguments sshell"> confirmed </span>
</span></code></pre><ol><li>Create CLI Keypair</li></ol><p>If this is your first time using the Solana CLI, you will need to generate a new keypair:</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana-keygen</span></span><span class="smeta sfunction-call sarguments sshell"> new</span>
</span></code></pre><p>This is the expected output</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Generating</span></span><span class="smeta sfunction-call sarguments sshell"> a new keypair</span>

<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">For</span></span><span class="smeta sfunction-call sarguments sshell"> added security, enter a BIP39 passphrase</span>

<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">NOTE!</span></span><span class="smeta sfunction-call sarguments sshell"> This passphrase improves security of the recovery seed phrase NOT the</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">keypair</span></span><span class="smeta sfunction-call sarguments sshell"> file itself, which is stored as insecure plain text</span>

<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">BIP39</span></span><span class="smeta sfunction-call sarguments sshell"> Passphrase (empty for none</span><span class="smeta sfunction-call sshell"></span><span class="smeta spost-cmd sshell">)</span><span class="smeta sfunction-call sshell"><span class="ssupport sfunction scolon sshell">:</span></span><span class="smeta sfunction-call sarguments sshell"> </span>

<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Wrote</span></span><span class="smeta sfunction-call sarguments sshell"> new keypair to /home/kelvin/.config/solana/id.json</span>
<span class="skeyword soperator sassignment sshell">=</span><span class="sstring sunquoted sshell">===========================================================================</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">pubkey:</span></span><span class="smeta sfunction-call sarguments sshell"> 2ab2mQwRzTYCoXThK4mi8M7fTfGzV48ftpE3xNJvKem3</span>
<span class="skeyword soperator sassignment sshell">=</span><span class="sstring sunquoted sshell">===========================================================================</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Save</span></span><span class="smeta sfunction-call sarguments sshell"> this seed phrase and your BIP39 passphrase to recover your new keypair:</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">make</span></span><span class="smeta sfunction-call sarguments sshell"> museum conduct seven dose glide recipe bring film differ excite chapter</span>
<span class="skeyword soperator sassignment sshell">=</span><span class="sstring sunquoted sshell">===========================================================================</span>
</span></code></pre><p>Note that you should <strong>never</strong> publish your seed phrase to the internet. Am doing this for educational purposes only and will never use this keypair again.</p><h3><strong>Start local Solana cluster</strong></h3><p>This example connects to a local Solana cluster by default.</p><p>Start a local Solana cluster:</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana-test-validator</span></span>
</span></code></pre><p>Expected output:</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana-test-validator</span></span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Ledger</span></span><span class="smeta sfunction-call sarguments sshell"> location: test-ledger</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Log:</span></span><span class="smeta sfunction-call sarguments sshell"> test-ledger/validator.log</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Identity:</span></span><span class="smeta sfunction-call sarguments sshell"> GZr7zHFUxA7kjGgzUsUuRfQtNASBCGurynEg7yUDcfvP</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Genesis</span></span><span class="smeta sfunction-call sarguments sshell"> Hash: F945qQyeHDUXN58eUWuLHLogAZ7Qgkpucc7xe8LisQnR</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Version:</span></span><span class="smeta sfunction-call sarguments sshell"> 1.6.9</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Shred</span></span><span class="smeta sfunction-call sarguments sshell"> Version: 54687</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Gossip</span></span><span class="smeta sfunction-call sarguments sshell"> Address: 127.0.0.1:1025</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">TPU</span></span><span class="smeta sfunction-call sarguments sshell"> Address: 127.0.0.1:1027</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">JSON</span></span><span class="smeta sfunction-call sarguments sshell"> RPC URL: http://127.0.0.1:8899</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">⠒</span></span><span class="smeta sfunction-call sarguments sshell"> 00:00:08</span> <span class="skeyword soperator slogical spipe sshell">|</span> <span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Processed</span></span><span class="smeta sfunction-call sarguments sshell"> Slot: 16</span> <span class="skeyword soperator slogical spipe sshell">|</span> <span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Confirmed</span></span><span class="smeta sfunction-call sarguments sshell"> Slot: 16</span> <span class="skeyword soperator slogical spipe sshell">|</span> <span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Finalized</span></span><span class="smeta sfunction-call sarguments sshell"> Slot: 0</span> <span class="skeyword soperator slogical spipe sshell">|</span> <span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Snapshot</span></span><span class="smeta sfunction-call sarguments sshell"> Slot:</span>
</span></code></pre><p>And the log monitor in another terminal:</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">$</span></span><span class="smeta sfunction-call sarguments sshell"> solana logs</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Streaming</span></span><span class="smeta sfunction-call sarguments sshell"> transaction logs. Confirmed commitment</span>
</span></code></pre><p>We don’t see any logs yet because we have not deployed our program.</p><h3><strong>Build the on-chain program</strong></h3><p>Open a third terminal to build our Rust version of the onchain program:</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">npm</span></span><span class="smeta sfunction-call sarguments sshell"> run build:program-rust</span>
</span></code></pre><p>If the build is successful, you’ll get a message informing that you should now deploy your program.</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">To</span></span><span class="smeta sfunction-call sarguments sshell"> deploy this program:</span>
  <span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">$</span></span><span class="smeta sfunction-call sarguments sshell"> solana program deploy /dist/program/helloworld.so</span>
</span></code></pre><h3><strong>Deploy the on-chain program</strong></h3><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana</span></span><span class="smeta sfunction-call sarguments sshell"> program deploy dist/program/helloworld.so</span>
</span></code></pre><p>You should see something like this:</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">solana</span></span><span class="smeta sfunction-call sarguments sshell"> program deploy dist/program/helloworld.so</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Program</span></span><span class="smeta sfunction-call sarguments sshell"> Id: CixWRTY8QcWP6F2maA9uhPLcJuch7njckQswwP5dTx9z</span>

</span></code></pre><p>Now if you go back to the the log terminal, you should see a stream of transaction logs.</p><p>That’s it with the onchain program. Let’s see how to interact with it and send transactions from the clientside!</p><h2>Building the clientside.</h2><p>To interact with a Solana node inside a JavaScript application, we use the solana-web3.js library, which gives a convenient interface for the RPC methods.</p><p>Now that we have an onchain program, let’s see how we can make calls to the blockchain. In the helloworld program folder, run the following command to install the dependencies the client needs</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="ssupport sfunction scd sshell">cd</span></span><span class="smeta sfunction-call sarguments sshell"> helloworld-example</span>
<span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">npm</span></span><span class="smeta sfunction-call sarguments sshell"> install</span>
</span></code></pre><p>The client has three typescript files: <code class ='scode'>hello_world.ts</code>, <code class ='scode'>main.ts</code>, <code class ='scode'>utils.ts</code>. We define our functions in <em>hello_world.ts</em> and export them to <em>main.ts</em>, which is the client’s entrypoint while <em>utils.ts</em> is mostly for configurations. Here’s how utils.ts looks like, without the imports.</p><pre class='scode'><code><span class="ssource sjs"><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sjs">async</span> <span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">getConfig</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="svariable sother sreadwrite sjs">any</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Path to Solana CLI config file
</span>  const CONFIG_FILE_PATH = path.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">resolve</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>
    <span class="svariable sparameter sfunction sjs">os</span>.<span class="svariable sparameter sfunction sjs">homedir</span>(<span class="spunctuation ssection sgroup send sjs">)</span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sobject-literal skey sjs"><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>.config<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sobject-literal skey sjs"><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>solana<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sobject-literal skey sjs"><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>cli<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sobject-literal skey sjs"><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>config.yml<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
  );
  const configYml = await fs.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">readFile</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">CONFIG_FILE_PATH</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sbegin sjs">{</span><span class="svariable sparameter sfunction sjs">encoding</span>: &#39;<span class="svariable sparameter sfunction sjs">utf8</span>&#39;<span class="spunctuation ssection sblock send sjs">}</span></span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
  return yaml.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">parse</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">configYml</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
<span class="spunctuation ssection sblock sjs">}</span></span>
<span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span>Load and parse the Solana CLI config file to determine which RPC url to use
</span><span class="smeta sexport sjs"><span class="skeyword scontrol simport-export sjs">export</span> <span class="svariable sother sreadwrite sjs">async</span> </span><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">getRpcUrl</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="svariable sother sreadwrite sjs">string</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  try {
    const config = await <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">getConfig</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
    <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">if</span><span class="smeta sfunction sdeclaration sjs"> </span><span class="spunctuation ssection sgroup sbegin sjs">(</span>!<span class="svariable sparameter sfunction sjs">config</span>.<span class="svariable sparameter sfunction sjs">json_rpc_url</span><span class="spunctuation ssection sgroup send sjs">)</span><span class="smeta sfunction sdeclaration sjs"> </span></span>throw new <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">Error</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>&#39;<span class="svariable sparameter sfunction sjs">Missing</span> <span class="svariable sparameter sfunction sjs">RPC</span> <span class="svariable sparameter sfunction sjs">URL</span>&#39;<span class="spunctuation ssection sgroup send sjs">)</span></span>;
    return config.json_rpc_url;
  <span class="spunctuation ssection sblock sjs">}</span></span> <span class="smeta scatch sjs"><span class="skeyword scontrol strycatch sjs">catch</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">err</span><span class="spunctuation ssection sgroup sjs">)</span></span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="smeta sfunction-call smethod sjs"><span class="ssupport stype sobject sconsole sjs">console</span><span class="spunctuation saccessor sjs">.</span><span class="ssupport sfunction sconsole sjs">warn</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
      <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>Failed to read RPC url from CLI config file, falling back to localhost<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sseparator scomma sjs">,</span>
    </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
    <span class="skeyword scontrol sflow sjs">return</span> <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>http://localhost:8899<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  </span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span>
}
 <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span>Load and parse the Solana CLI config file to determine which payer to use
</span><span class="smeta sexport sjs"><span class="skeyword scontrol simport-export sjs">export</span> <span class="svariable sother sreadwrite sjs">async</span> </span><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">getPayer</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="svariable sother sreadwrite sjs">Keypair</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  try {
    const config = await <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">getConfig</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
    <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">if</span><span class="smeta sfunction sdeclaration sjs"> </span><span class="spunctuation ssection sgroup sbegin sjs">(</span>!<span class="svariable sparameter sfunction sjs">config</span>.<span class="svariable sparameter sfunction sjs">keypair_path</span><span class="spunctuation ssection sgroup send sjs">)</span><span class="smeta sfunction sdeclaration sjs"> </span></span>throw new <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">Error</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>&#39;<span class="svariable sparameter sfunction sjs">Missing</span> <span class="svariable sparameter sfunction sjs">keypair</span> <span class="svariable sparameter sfunction sjs">path</span>&#39;<span class="spunctuation ssection sgroup send sjs">)</span></span>;
    return await <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">createKeypairFromFile</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">config</span>.<span class="svariable sparameter sfunction sjs">keypair_path</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
  <span class="spunctuation ssection sblock sjs">}</span></span> <span class="smeta scatch sjs"><span class="skeyword scontrol strycatch sjs">catch</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">err</span><span class="spunctuation ssection sgroup sjs">)</span></span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="smeta sfunction-call smethod sjs"><span class="ssupport stype sobject sconsole sjs">console</span><span class="spunctuation saccessor sjs">.</span><span class="ssupport sfunction sconsole sjs">warn</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
      <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>Failed to create keypair from CLI config file, falling back to new random keypair<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sseparator scomma sjs">,</span>
    </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
    <span class="skeyword scontrol sflow sjs">return</span> <span class="svariable sother sobject sjs">Keypair</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">generate</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  </span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span>
}
 <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Create a Keypair from a secret key stored in file as bytes&#39; array
</span><span class="smeta sexport sjs"><span class="skeyword scontrol simport-export sjs">export</span> <span class="svariable sother sreadwrite sjs">async</span> </span><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">createKeypairFromFile</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>
  <span class="svariable sparameter sfunction sjs">filePath</span>: <span class="svariable sparameter sfunction sjs">string</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span>
<span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="svariable sother sreadwrite sjs">Keypair</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  const secretKeyString = await fs.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">readFile</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">filePath</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sbegin sjs">{</span><span class="svariable sparameter sfunction sjs">encoding</span>: &#39;<span class="svariable sparameter sfunction sjs">utf8</span>&#39;<span class="spunctuation ssection sblock send sjs">}</span></span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
  const secretKey = Uint<span class="smeta sobject-literal skey sjs">8Array.from(JSON.parse(secretKeyString));
  return Keypair.fromSecretKey(secretKey);
}
</span></span></span></code></pre><p>The <code class ='scode'>getConfig</code> function returns the path to the Solana CLI configuration file. In <code class ='scode'>getRpcUrl</code>, we determine which RPC we’re using, and since we’re on the local cluster, we return our localhost URL, which is Solana’s default 8899.</p><p>Whenever you are sending transactions to Solana asking it to execute your instructions, like saying hello to another account - you must pay some lamports for execution. Lamport refers to the smallest denominational unit of Sol tokens(like wei in ethereum). If the lamports are in your account, you need to sign the transaction with your private key so no one else can spend your lamports. This private key is stored in your local filesystem as an array of bytes. The <code class ='scode'>createKeypairFromFile</code> function decodes this array and returns it as a Keypair using the <code class ='scode'>fromSecretKey</code> method <a href='https://solana-labs.github.io/solana-web3.js/classes/Keypair.html#fromSecretKey'>provided</a> to us by the JSON rpc API. The <code class ='scode'>getPayer</code> function returns a Keypair that is debited everytime we make a transaction.</p><p>Now that we have our configurations in place, let’s look at the code in hello_world.ts which is where the juicier stuff is. I have not included the imports and some declarations because the comments in the code are sufficient explanations.</p><pre class='scode'><code><span class="ssource sjs"><span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> The state of a greeting account managed by the hello world program
</span><span class="smeta sclass sjs"><span class="sstorage stype sclass sjs">class</span> <span class="sentity sname sclass sjs">GreetingAccount</span> <span class="smeta sclass sjs"><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span></span></span></span><span class="smeta sclass sjs"><span class="smeta sblock sjs">
  counter = 0;
  <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">constructor</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">fields</span>: <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sbegin sjs">{</span><span class="svariable sparameter sfunction sjs">counter</span>: <span class="svariable sparameter sfunction sjs">number</span><span class="spunctuation ssection sblock send sjs">}</span></span> | <span class="svariable sparameter sfunction sjs">undefined</span> <span class="smeta sparameter soptional sjs"><span class="skeyword soperator sassignment sjs">=</span> <span class="sconstant slanguage sundefined sjs">undefined</span></span><span class="spunctuation ssection sgroup send sjs">)</span><span class="smeta sfunction sdeclaration sjs"> </span></span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="smeta sconditional sjs"><span class="skeyword scontrol sconditional sjs">if</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">fields</span><span class="spunctuation ssection sgroup sjs">)</span></span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
      <span class="svariable slanguage sthis sjs">this</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">counter</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sobject sjs">fields</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">counter</span><span class="spunctuation sterminator sstatement sjs">;</span>
    </span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span>
  <span class="spunctuation ssection sblock sjs">}</span></span>
<span class="spunctuation ssection sblock sjs">}</span></span></span>
<span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span>Borsh schema definition for greeting accounts
</span><span class="sstorage stype sjs">const</span> <span class="svariable sother sreadwrite sjs">GreetingSchema</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="smeta sinstance sconstructor sjs"><span class="skeyword soperator sword snew sjs">new</span><span class="smeta sfunction-call sconstructor sjs"> <span class="ssupport sclass sbuiltin sjs">Map</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="smeta ssequence sjs"><span class="spunctuation ssection sbrackets sjs">[</span>
  <span class="smeta ssequence sjs"><span class="spunctuation ssection sbrackets sjs">[</span><span class="svariable sother sreadwrite sjs">GreetingAccount</span><span class="spunctuation sseparator scomma sjs">,</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span><span class="smeta sobject-literal skey sjs">kind</span><span class="spunctuation sseparator skey-value sjs">:</span> <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>struct<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sseparator scomma sjs">,</span> <span class="smeta sobject-literal skey sjs">fields</span><span class="spunctuation sseparator skey-value sjs">:</span> <span class="smeta ssequence sjs"><span class="spunctuation ssection sbrackets sjs">[</span><span class="smeta ssequence sjs"><span class="spunctuation ssection sbrackets sjs">[</span><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>counter<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sseparator scomma sjs">,</span> <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>u32<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation ssection sbrackets sjs">]</span></span><span class="spunctuation ssection sbrackets sjs">]</span></span><span class="spunctuation ssection sblock sjs">}</span></span><span class="spunctuation ssection sbrackets sjs">]</span></span><span class="spunctuation sseparator scomma sjs">,</span>
<span class="spunctuation ssection sbrackets sjs">]</span></span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
<span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span>The expected size of each greeting account.
</span><span class="sstorage stype sjs">const</span> <span class="svariable sother sconstant sjs">GREETING_SIZE</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sobject sjs">borsh</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">serialize</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
  <span class="svariable sother sreadwrite sjs">GreetingSchema</span><span class="spunctuation sseparator scomma sjs">,</span>
  <span class="smeta sinstance sconstructor sjs"><span class="skeyword soperator sword snew sjs">new</span><span class="smeta sfunction-call sconstructor sjs"> <span class="svariable stype sjs">GreetingAccount</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">length</span><span class="spunctuation sterminator sstatement sjs">;</span>
</span></code></pre><p>We create a typescript class that we’ll use to represent our account’s data. Remember the struct we created in Rust?</p><pre class='scode'><code><span class="ssource srust"><span class="smeta sstruct srust"><span class="sstorage smodifier srust">pub</span> <span class="sstorage stype sstruct srust">struct</span> </span><span class="smeta sstruct srust"><span class="sentity sname sstruct srust">GreetingAccount</span> </span><span class="smeta sstruct srust"><span class="smeta sblock srust"><span class="spunctuation ssection sblock sbegin srust">{</span>
    <span class="sstorage smodifier srust">pub</span> <span class="svariable sother smember srust">counter</span><span class="spunctuation sseparator srust">:</span> <span class="sstorage stype srust">u32</span>,
</span><span class="smeta sblock srust"><span class="spunctuation ssection sblock send srust">}</span></span></span>
</span></code></pre><p>The GreetingSchema constant maps the GreetingAccount from the client side to the struct in our Rust program. <code class ='scode'>kind</code> tell the schema that we are mapping GreetingAccount to a type struct. <code class ='scode'>fields</code> refers to to the name of the elements in the struct and it’s type.We need to pass fields as an array because we could have multiple elements. We serialize the data in GreetingAccount into an array of bytes and calculate its size using <code class ='scode'>.length</code>. We store the data in <code class ='scode'>GREETING_SIZE</code> and we’ll later use it to calculate the rent amount we have to pay for storing data on the blockchain.(more of this in a few).</p><h3>Establish a connection to the cluster.</h4><pre class='scode'><code><span class="ssource sjs"><span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span>Establish a connection to the cluster
</span><span class="smeta sexport sjs"><span class="skeyword scontrol simport-export sjs">export</span> <span class="svariable sother sreadwrite sjs">async</span> </span><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">establishConnection</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="skeyword soperator sjs">void</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  const rpcUrl = await <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">getRpcUrl</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
  connection = new <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">Connection</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">rpcUrl</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span> &#39;<span class="svariable sparameter sfunction sjs">confirmed</span>&#39;<span class="spunctuation ssection sgroup send sjs">)</span></span>;
  const version = await connection.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">getVersion</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
  console.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">log</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>&#39;<span class="svariable sparameter sfunction sjs">Connection</span> <span class="svariable sparameter sfunction sjs">to</span> <span class="svariable sparameter sfunction sjs">cluster</span> <span class="svariable sparameter sfunction sjs">established</span>:&#39;<span class="spunctuation sseparator sparameter sfunction sjs">,</span> <span class="svariable sparameter sfunction sjs">rpcUrl</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span> <span class="svariable sparameter sfunction sjs">version</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
<span class="spunctuation ssection sblock sjs">}</span></span>
</span></code></pre><p>Above, we establish a connection to the cluster using the establishConnection() function. Notice how we get the rpc url from the <code class ='scode'>getRpcUrl()</code> function we created in util.js?</p><h4>Paying for rent and transactions.</h4><p>In <code class ='scode'>utils.js</code>, we established an account keypair, <code class ='scode'>getPayer</code> that is debited every time we make a transaction. In Solana, we also have <a href='https://docs.solana.com/developing/programming-model/accounts#rent'>to pay rent</a> for the storage cost of keeping the account alive. However, an account can be made entirely exempt from rent collection by depositing at least 2 years worth of rent. The <code class ='scode'>getMinimumBalanceForRentExemption</code> API <a href='https://docs.solana.com/developing/clients/jsonrpc-api#getminimumbalanceforrentexemption'>can be used</a> to get the minimum balance required for a particular account. Notice how we pass the GREETING_SIZE constant we declared earlier? The RPC also <a href='https://docs.solana.com/developing/clients/jsonrpc-api#getrecentblockhash'>provides us</a> with the <code class ='scode'>getRecentBlockhash</code> function that returns a fee schedule that can be used to compute the cost of submitting a transaction.  Validators charge a <a href='https://docs.solana.com/implemented-proposals/transaction-fees#congestion-driven-fees'>lamportsPerSignature</a> fee incase the network is congested. Because we are on a testnet and don’t care about money, we multiply the fee by 1OO to make sure our transactions never get rejected, at least not for lack of money.</p><pre class='scode'><code><span class="ssource sjs"><span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span>Establish an account to pay for everything
</span><span class="smeta sexport sjs"><span class="skeyword scontrol simport-export sjs">export</span> <span class="svariable sother sreadwrite sjs">async</span> </span><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">establishPayer</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="skeyword soperator sjs">void</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  let fees = <span class="smeta sobject-literal skey sjs"><span class="sconstant snumeric sjs">0</span></span>;
  <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">if</span><span class="smeta sfunction sdeclaration sjs"> </span><span class="spunctuation ssection sgroup sbegin sjs">(</span>!<span class="svariable sparameter sfunction sjs">payer</span><span class="spunctuation ssection sgroup send sjs">)</span><span class="smeta sfunction sdeclaration sjs"> </span></span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="sstorage stype sjs">const</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span><span class="svariable sother sreadwrite sjs">feeCalculator</span><span class="spunctuation ssection sblock sjs">}</span></span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="svariable sother sobject sjs">connection</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">getRecentBlockhash</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
    <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Calculate the cost to fund the greeter account
</span>    <span class="svariable sother sreadwrite sjs">fees</span> <span class="skeyword soperator sassignment saugmented sjs">+=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="svariable sother sobject sjs">connection</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">getMinimumBalanceForRentExemption</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sconstant sjs">GREETING_SIZE</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
    <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Calculate the cost of sending transactions
</span>    <span class="svariable sother sreadwrite sjs">fees</span> <span class="skeyword soperator sassignment saugmented sjs">+=</span> <span class="svariable sother sobject sjs">feeCalculator</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">lamportsPerSignature</span> <span class="skeyword soperator sarithmetic sjs">*</span> <span class="sconstant snumeric sjs">100</span><span class="spunctuation sterminator sstatement sjs">;</span> <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> wag
</span>    <span class="svariable sother sreadwrite sjs">payer</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="smeta sfunction-call sjs"><span class="svariable sfunction sjs">getPayer</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  <span class="spunctuation ssection sblock sjs">}</span></span>
  let lamports = await connection.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">getBalance</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">payer</span>.<span class="svariable sparameter sfunction sjs">publicKey</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
  <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">if</span><span class="smeta sfunction sdeclaration sjs"> </span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">lamports</span> &lt; <span class="svariable sparameter sfunction sjs">fees</span><span class="spunctuation ssection sgroup send sjs">)</span><span class="smeta sfunction sdeclaration sjs"> </span></span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> If current balance is not enough to pay for fees, request an airdrop
</span>    <span class="sstorage stype sjs">const</span> <span class="svariable sother sreadwrite sjs">sig</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="svariable sother sobject sjs">connection</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">requestAirdrop</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
      <span class="svariable sother sobject sjs">payer</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">publicKey</span><span class="spunctuation sseparator scomma sjs">,</span>
      <span class="svariable sother sreadwrite sjs">fees</span> <span class="skeyword soperator sarithmetic sjs">-</span> <span class="svariable sother sreadwrite sjs">lamports</span><span class="spunctuation sseparator scomma sjs">,</span>
    </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
    <span class="skeyword scontrol sflow sjs">await</span> <span class="svariable sother sobject sjs">connection</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">confirmTransaction</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">sig</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
    <span class="svariable sother sreadwrite sjs">lamports</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="svariable sother sobject sjs">connection</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">getBalance</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sobject sjs">payer</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">publicKey</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  <span class="spunctuation ssection sblock sjs">}</span></span>

  console.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">log</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>
    &#39;<span class="svariable sparameter sfunction sjs">Using</span> <span class="svariable sparameter sfunction sjs">account</span>&#39;<span class="spunctuation sseparator sparameter sfunction sjs">,</span>
    <span class="svariable sparameter sfunction sjs">payer</span>.<span class="svariable sparameter sfunction sjs">publicKey</span>.<span class="svariable sparameter sfunction sjs">toBase58</span>(<span class="spunctuation ssection sgroup send sjs">)</span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sobject-literal skey sjs"><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>containing<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
    lamports / <span class="svariable sother sreadwrite sjs">LAMPORTS_PER_SOL</span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sobject-literal skey sjs"><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>SOL to pay for fees<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
  );
<span class="spunctuation ssection sblock sjs">}</span></span>
</span></code></pre><h4>Check if the hello world BPF program has been deployed</h4><p>The client loads the keypair of the deployed program from the file whose path we defined in <code class ='scode'>PROGRAM_KEYPAIR_PATH </code>constant and then read the programId from file. If the program isn’t found, we return an error.</p><pre class='scode'><code><span class="ssource sjs"><span class="smeta sexport sjs"><span class="skeyword scontrol simport-export sjs">export</span> <span class="svariable sother sreadwrite sjs">async</span> </span><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">checkProgram</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="skeyword soperator sjs">void</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Read program id from keypair file
</span>  try {
    const programKeypair = await <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">createKeypairFromFile</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">PROGRAM_KEYPAIR_PATH</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
    programId = programKeypair.publicKey;
  <span class="spunctuation ssection sblock sjs">}</span></span> <span class="smeta scatch sjs"><span class="skeyword scontrol strycatch sjs">catch</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">err</span><span class="spunctuation ssection sgroup sjs">)</span></span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="sstorage stype sjs">const</span> <span class="svariable sother sreadwrite sjs">errMsg</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">err</span> <span class="svariable sother sreadwrite sjs">as</span> <span class="ssupport sclass serror sjs">Error</span><span class="spunctuation ssection sgroup sjs">)</span></span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">message</span><span class="spunctuation sterminator sstatement sjs">;</span>
    <span class="skeyword scontrol strycatch sjs">throw</span> <span class="smeta sinstance sconstructor sjs"><span class="skeyword soperator sword snew sjs">new</span><span class="smeta sfunction-call sconstructor sjs"> <span class="ssupport sclass serror sjs">Error</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
      <span class="sstring stemplate sjs"><span class="spunctuation sdefinition sstring stemplate sbegin sjs">`</span>Failed to read program keypair at &#39;</span><span class="smeta stemplate sexpression sjs"><span class="spunctuation sdefinition stemplate-expression sbegin sjs">${</span></span><span class="smeta stemplate sexpression sjs"><span class="ssource sjs sembedded sexpression"><span class="svariable sother sconstant sjs">PROGRAM_KEYPAIR_PATH</span></span><span class="spunctuation sdefinition stemplate-expression send sjs">}</span></span><span class="sstring stemplate sjs">&#39; due to error: </span><span class="smeta stemplate sexpression sjs"><span class="spunctuation sdefinition stemplate-expression sbegin sjs">${</span></span><span class="smeta stemplate sexpression sjs"><span class="ssource sjs sembedded sexpression"><span class="svariable sother sreadwrite sjs">errMsg</span></span><span class="spunctuation sdefinition stemplate-expression send sjs">}</span></span><span class="sstring stemplate sjs">. Program may need to be deployed with <span class="sconstant scharacter sescape sjs">\`</span>solana program deploy rogram/helloworld.so<span class="sconstant scharacter sescape sjs">\`</span><span class="spunctuation sdefinition sstring stemplate send sjs">`</span></span><span class="spunctuation sseparator scomma sjs">,</span>
    </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  </span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span>
</span></code></pre><p>Below, we use the <code class ='scode'>getAccountInfo</code> method <a href='https://docs.solana.com/developing/clients/jsonrpc-api#getaccountinfo'>from the API</a> to retrieve programId. We perform the following checks.</p><ul><li>If the programId is not found, check to see if there is a compiled binary in the filesystem. Incase there is a compiled binary, we throw an error asking the user to deploy the program. </li><li>If a binary is not found, we throw an error asking the user to build and deploy the program.</li><li>Lastly, we check to see if the account is <a href='https://docs.solana.com/developing/programming-model/accounts#executable'>executable</a>. An executable account is one that has been successfully deployed and is owned by the BPF loader.</li><li>If all the checks are successful, we log the programId as in the console in string format.<pre class='scode'><code><span class="ssource sjs"><span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Check if the program has been deployed
</span><span class="sstorage stype sjs">const</span> <span class="svariable sother sreadwrite sjs">programInfo</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="svariable sother sobject sjs">connection</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">getAccountInfo</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">programId</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
<span class="smeta sconditional sjs"><span class="skeyword scontrol sconditional sjs">if</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">programInfo</span> <span class="skeyword soperator scomparison sjs">===</span> <span class="sconstant slanguage snull sjs">null</span><span class="spunctuation ssection sgroup sjs">)</span></span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
  <span class="smeta sconditional sjs"><span class="skeyword scontrol sconditional sjs">if</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sobject sjs">fs</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">existsSync</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sconstant sjs">PROGRAM_SO_PATH</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation ssection sgroup sjs">)</span></span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="skeyword scontrol strycatch sjs">throw</span> <span class="smeta sinstance sconstructor sjs"><span class="skeyword soperator sword snew sjs">new</span><span class="smeta sfunction-call sconstructor sjs"> <span class="ssupport sclass serror sjs">Error</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
      <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>Program needs to be deployed with `solana program deploy dist/program/helloworld.so`<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sseparator scomma sjs">,</span>
    </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  </span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span> <span class="smeta sconditional sjs"><span class="skeyword scontrol sconditional sjs">else</span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="skeyword scontrol strycatch sjs">throw</span> <span class="smeta sinstance sconstructor sjs"><span class="skeyword soperator sword snew sjs">new</span><span class="smeta sfunction-call sconstructor sjs"> <span class="ssupport sclass serror sjs">Error</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>Program needs to be built and deployed<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  </span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span>
</span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span> <span class="smeta sconditional sjs"><span class="skeyword scontrol sconditional sjs">else if</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="skeyword soperator slogical sjs">!</span><span class="svariable sother sobject sjs">programInfo</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">executable</span><span class="spunctuation ssection sgroup sjs">)</span></span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
  <span class="skeyword scontrol strycatch sjs">throw</span> <span class="smeta sinstance sconstructor sjs"><span class="skeyword soperator sword snew sjs">new</span><span class="smeta sfunction-call sconstructor sjs"> <span class="ssupport sclass serror sjs">Error</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="sstring stemplate sjs"><span class="spunctuation sdefinition sstring stemplate sbegin sjs">`</span>Program is not executable<span class="spunctuation sdefinition sstring stemplate send sjs">`</span></span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
</span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span>
<span class="smeta sfunction-call smethod sjs"><span class="ssupport stype sobject sconsole sjs">console</span><span class="spunctuation saccessor sjs">.</span><span class="ssupport sfunction sconsole sjs">log</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="sstring stemplate sjs"><span class="spunctuation sdefinition sstring stemplate sbegin sjs">`</span>Using program </span><span class="smeta stemplate sexpression sjs"><span class="spunctuation sdefinition stemplate-expression sbegin sjs">${</span></span><span class="smeta stemplate sexpression sjs"><span class="ssource sjs sembedded sexpression"><span class="svariable sother sobject sjs">programId</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">toBase58</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation sdefinition stemplate-expression send sjs">}</span></span><span class="sstring stemplate sjs"><span class="spunctuation sdefinition sstring stemplate send sjs">`</span></span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
</span></code></pre></li></ul><p>Using the <code class ='scode'>createWithSeed</code> method from <a href='https://solana-labs.github.io/solana-web3.js/classes/PublicKey.html#createWithSeed'>web3js</a>, we derive a public key from another key, a seed, and a program ID. The program ID will also serve as the owner of the public key, giving it permission to write data to the account. We check to see if the account does not already exist, and if so, make a transaction to create the account using the SystemProgram’s createAccountFromSeed property. In Solana, the system program is responsible for creating new accounts. <code class ='scode'>sendAndConfirmTransaction</code> <a href='https://solana-labs.github.io/solana-web3.js/modules.html#sendAndConfirmTransaction'>does what it says</a>. We have to pass the RPC endpoint, transaction we just created, and the signer as parameters.</p><pre class='scode'><code><span class="ssource sjs"><span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Derive the address (public key) of a greeting account from the program so that it&#39;s easy to find later.
</span><span class="sstorage stype sjs">const</span> <span class="svariable sother sconstant sjs">GREETING_SEED</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>hello<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sterminator sstatement sjs">;</span>
<span class="svariable sother sreadwrite sjs">greetedPubkey</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="svariable sother sobject sjs">PublicKey</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">createWithSeed</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
  <span class="svariable sother sobject sjs">payer</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">publicKey</span><span class="spunctuation sseparator scomma sjs">,</span>
  <span class="svariable sother sconstant sjs">GREETING_SEED</span><span class="spunctuation sseparator scomma sjs">,</span>
  <span class="svariable sother sreadwrite sjs">programId</span><span class="spunctuation sseparator scomma sjs">,</span>
</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
<span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Check if the greeting account has already been created
</span><span class="sstorage stype sjs">const</span> <span class="svariable sother sreadwrite sjs">greetedAccount</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="svariable sother sobject sjs">connection</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">getAccountInfo</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">greetedPubkey</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
<span class="smeta sconditional sjs"><span class="skeyword scontrol sconditional sjs">if</span> <span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">greetedAccount</span> <span class="skeyword soperator scomparison sjs">===</span> <span class="sconstant slanguage snull sjs">null</span><span class="spunctuation ssection sgroup sjs">)</span></span> <span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
  <span class="smeta sfunction-call smethod sjs"><span class="ssupport stype sobject sconsole sjs">console</span><span class="spunctuation saccessor sjs">.</span><span class="ssupport sfunction sconsole sjs">log</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
    <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>Creating account<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="svariable sother sobject sjs">greetedPubkey</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">toBase58</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>to say hello to<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sseparator scomma sjs">,</span>
  </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  <span class="sstorage stype sjs">const</span> <span class="svariable sother sreadwrite sjs">lamports</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="svariable sother sreadwrite sjs">await</span> <span class="svariable sother sobject sjs">connection</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">getMinimumBalanceForRentExemption</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
    <span class="svariable sother sconstant sjs">GREETING_SIZE</span><span class="spunctuation sseparator scomma sjs">,</span>
  </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>

  <span class="sstorage stype sjs">const</span> <span class="svariable sother sreadwrite sjs">transaction</span> <span class="skeyword soperator sassignment sjs">=</span> <span class="smeta sinstance sconstructor sjs"><span class="skeyword soperator sword snew sjs">new</span><span class="smeta sfunction-call sconstructor sjs"> <span class="svariable stype sjs">Transaction</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="ssupport sfunction sdom sjs">add</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
    <span class="svariable sother sobject sjs">SystemProgram</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="svariable sfunction sjs">createAccountWithSeed</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
      <span class="smeta sobject-literal skey sjs">fromPubkey</span><span class="spunctuation sseparator skey-value sjs">:</span> <span class="svariable sother sobject sjs">payer</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">publicKey</span><span class="spunctuation sseparator scomma sjs">,</span>
      <span class="smeta sobject-literal skey sjs">basePubkey</span><span class="spunctuation sseparator skey-value sjs">:</span> <span class="svariable sother sobject sjs">payer</span><span class="spunctuation saccessor sjs">.</span><span class="smeta sproperty sobject sjs">publicKey</span><span class="spunctuation sseparator scomma sjs">,</span>
      <span class="smeta sobject-literal skey sjs">seed</span><span class="spunctuation sseparator skey-value sjs">:</span> <span class="svariable sother sconstant sjs">GREETING_SEED</span><span class="spunctuation sseparator scomma sjs">,</span>
      <span class="smeta sobject-literal skey sjs">newAccountPubkey</span><span class="spunctuation sseparator skey-value sjs">:</span> <span class="svariable sother sreadwrite sjs">greetedPubkey</span><span class="spunctuation sseparator scomma sjs">,</span>
      <span class="svariable sother sreadwrite sjs">lamports</span><span class="spunctuation sseparator scomma sjs">,</span>
      <span class="smeta sobject-literal skey sjs">space</span><span class="spunctuation sseparator skey-value sjs">:</span> <span class="svariable sother sconstant sjs">GREETING_SIZE</span><span class="spunctuation sseparator scomma sjs">,</span>
      <span class="svariable sother sreadwrite sjs">programId</span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="spunctuation ssection sblock sjs">}</span></span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
  </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  <span class="skeyword scontrol sflow sjs">await</span> <span class="smeta sfunction-call sjs"><span class="svariable sfunction sjs">sendAndConfirmTransaction</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">connection</span><span class="spunctuation sseparator scomma sjs">,</span> <span class="svariable sother sreadwrite sjs">transaction</span><span class="spunctuation sseparator scomma sjs">,</span> <span class="smeta ssequence sjs"><span class="spunctuation ssection sbrackets sjs">[</span><span class="svariable sother sreadwrite sjs">payer</span><span class="spunctuation ssection sbrackets sjs">]</span></span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
</span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">}</span></span></span>
}
</span></code></pre><p>In the sayHello function below, we create an instruction using the <code class ='scode'>TransactionInstruction</code> <a href='https://solana-labs.github.io/solana-web3.js/classes/TransactionInstruction.html'>class from</a> web3 API. The keys is the account metadata which takes the following format: <code class ='scode'>AccountMeta: { pubkey: PublicKey; isSigner: boolean; isWritable: boolean; }</code> In our example, the pubkey we pass as metadata is that of the greetedAccount we’re saying hello to. We also state that the transaction doesn’t need a signer and it’s both read and write. We allocate 0 bytes data size because we didn’t pass any data while creating our program. We said it just <em>hellos</em>, remember? We send and confirm just like we did in the other transaction.</p><pre class='scode'><code><span class="ssource sjs"><span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Say hello
</span><span class="smeta sexport sjs"><span class="skeyword scontrol simport-export sjs">export</span> <span class="svariable sother sreadwrite sjs">async</span> </span><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">sayHello</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="skeyword soperator sjs">void</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  console.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">log</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>&#39;<span class="svariable sparameter sfunction sjs">Saying</span> <span class="svariable sparameter sfunction sjs">hello</span> <span class="svariable sparameter sfunction sjs">to</span>&#39;<span class="spunctuation sseparator sparameter sfunction sjs">,</span> <span class="svariable sparameter sfunction sjs">greetedPubkey</span>.<span class="svariable sparameter sfunction sjs">toBase58</span>(<span class="spunctuation ssection sgroup send sjs">)</span></span>);
  const instruction = new <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">TransactionInstruction</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sbegin sjs">{</span>
    <span class="svariable sparameter sfunction sjs">keys</span>: [{<span class="svariable sparameter sfunction sjs">pubkey</span>: <span class="svariable sparameter sfunction sjs">greetedPubkey</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span> <span class="svariable sparameter sfunction sjs">isSigner</span>: <span class="svariable sparameter sfunction sjs">false</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span> <span class="svariable sparameter sfunction sjs">isWritable</span>: <span class="svariable sparameter sfunction sjs">true</span><span class="spunctuation ssection sblock send sjs">}</span></span>]<span class="spunctuation sseparator sparameter sfunction sjs">,</span>
    <span class="svariable sparameter sfunction sjs">programId</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span>
    <span class="svariable sparameter sfunction sjs">data</span>: <span class="svariable sparameter sfunction sjs">Buffer</span>.<span class="svariable sparameter sfunction sjs">alloc</span>(0<span class="spunctuation ssection sgroup send sjs">)</span></span><span class="spunctuation sseparator scomma sjs">,</span> <span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> All instructions are hellos
</span>  <span class="spunctuation ssection sblock sjs">}</span></span><span class="sinvalid sillegal sstray-bracket-end sjs">)</span><span class="spunctuation sterminator sstatement sjs">;</span>
  <span class="skeyword scontrol sflow sjs">await</span> <span class="smeta sfunction-call sjs"><span class="svariable sfunction sjs">sendAndConfirmTransaction</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span>
    <span class="svariable sother sreadwrite sjs">connection</span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sinstance sconstructor sjs"><span class="skeyword soperator sword snew sjs">new</span><span class="smeta sfunction-call sconstructor sjs"> <span class="svariable stype sjs">Transaction</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span></span><span class="spunctuation saccessor sjs">.</span><span class="smeta sfunction-call smethod sjs"><span class="ssupport sfunction sdom sjs">add</span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">(</span><span class="svariable sother sreadwrite sjs">instruction</span></span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta ssequence sjs"><span class="spunctuation ssection sbrackets sjs">[</span><span class="svariable sother sreadwrite sjs">payer</span><span class="spunctuation ssection sbrackets sjs">]</span></span><span class="spunctuation sseparator scomma sjs">,</span>
  </span><span class="smeta sgroup sjs"><span class="spunctuation ssection sgroup sjs">)</span></span></span><span class="spunctuation sterminator sstatement sjs">;</span>
}
</span></code></pre><p>Every time a client says hello, <code class ='scode'>GreetingAccount </code>increments counter by one. We deserialize GreetingAccount to get how many times the account we’ve created has been greeted from the counter and log the number to the console.</p><pre class='scode'><code><span class="ssource sjs"><span class="scomment sline sdouble-slash sjs"><span class="spunctuation sdefinition scomment sjs">//</span> Report the number of times the greeted account has been said hello to
</span><span class="smeta sexport sjs"><span class="skeyword scontrol simport-export sjs">export</span> <span class="svariable sother sreadwrite sjs">async</span> </span><span class="smeta sfunction sdeclaration sjs"><span class="sstorage stype sfunction sjs">function</span> <span class="sentity sname sfunction sjs">reportGreetings</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="spunctuation ssection sgroup send sjs">)</span></span>: <span class="ssupport sclass sbuiltin sjs">Promise</span><span class="skeyword soperator srelational sjs">&lt;</span><span class="skeyword soperator sjs">void</span><span class="skeyword soperator srelational sjs">&gt;</span> <span class="smeta sobject-literal sjs"><span class="spunctuation ssection sblock sjs">{</span>
  const accountInfo = await connection.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">getAccountInfo</span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">greetedPubkey</span><span class="spunctuation ssection sgroup send sjs">)</span></span>;
  <span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">if</span><span class="smeta sfunction sdeclaration sjs"> </span><span class="spunctuation ssection sgroup sbegin sjs">(</span><span class="svariable sparameter sfunction sjs">accountInfo</span> <span class="smeta sparameter soptional sjs"><span class="skeyword soperator sassignment sjs">=</span><span class="skeyword soperator scomparison sjs">==</span> <span class="sconstant slanguage snull sjs">null</span></span><span class="spunctuation ssection sgroup send sjs">)</span><span class="smeta sfunction sdeclaration sjs"> </span></span><span class="smeta sblock sjs"><span class="spunctuation ssection sblock sjs">{</span>
    <span class="skeyword scontrol strycatch sjs">throw</span> <span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>Error: cannot find the greeted account<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span><span class="spunctuation sterminator sstatement sjs">;</span>
  <span class="spunctuation ssection sblock sjs">}</span></span>
  const greeting = borsh.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">deserialize</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>
    <span class="svariable sparameter sfunction sjs">GreetingSchema</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span>
    <span class="svariable sparameter sfunction sjs">GreetingAccount</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span>
    <span class="svariable sparameter sfunction sjs">accountInfo</span>.<span class="svariable sparameter sfunction sjs">data</span><span class="spunctuation sseparator sparameter sfunction sjs">,</span>
  <span class="spunctuation ssection sgroup send sjs">)</span></span>;
  console.<span class="smeta sfunction sdeclaration sjs"><span class="sentity sname sfunction sjs">log</span><span class="spunctuation ssection sgroup sbegin sjs">(</span>
    <span class="svariable sparameter sfunction sjs">greetedPubkey</span>.<span class="svariable sparameter sfunction sjs">toBase58</span>(<span class="spunctuation ssection sgroup send sjs">)</span></span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sobject-literal skey sjs"><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>has been greeted<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
    greeting.<span class="svariable sother sreadwrite sjs">counter</span><span class="spunctuation sseparator scomma sjs">,</span>
    <span class="smeta sobject-literal skey sjs"><span class="sstring squoted ssingle sjs"><span class="spunctuation sdefinition sstring sbegin sjs">&#39;</span>time(s)<span class="spunctuation sdefinition sstring send sjs">&#39;</span></span></span><span class="spunctuation sseparator scomma sjs">,</span>
  );
<span class="spunctuation ssection sblock sjs">}</span></span>
</span></code></pre><p>If you go ahead and run <code class ='scode'>npm start</code>, you should have the following output:</p><pre class='scode'><code><span class="ssource sshell sbash"><span class="smeta sfunction-call sshell"><span class="svariable sfunction sshell">Let<span class="sstring squoted ssingle sshell"><span class="spunctuation sdefinition sstring sbegin sshell">&#39;</span>s say hello to a Solana account...
Connection to cluster established: http://localhost:8899 { <span class="spunctuation sdefinition sstring send sshell">&#39;</span></span>feature-set<span class="sstring squoted ssingle sshell"><span class="spunctuation sdefinition sstring sbegin sshell">&#39;</span>: 1140394761, <span class="spunctuation sdefinition sstring send sshell">&#39;</span></span>solana-core<span class="sstring squoted ssingle sshell"><span class="spunctuation sdefinition sstring sbegin sshell">&#39;</span>: <span class="spunctuation sdefinition sstring send sshell">&#39;</span></span>1.7.11<span class="sstring squoted ssingle sshell"><span class="spunctuation sdefinition sstring sbegin sshell">&#39;</span> }
Using account 2ab2mQwRzTYCoXThK4mi8M7fTfGzV48ftpE3xNJvKem3 containing 499999999.1441591 SOL to pay for fees
Using program CixWRTY8QcWP6F2maA9uhPLcJuch7njckQswwP5dTx9z
Creating account 9wtyFcYpzTnP6JgJow7KtFn7KbRymEfq5L2uqvEvq9cS to say hello to
Saying hello to 9wtyFcYpzTnP6JgJow7KtFn7KbRymEfq5L2uqvEvq9cS
9wtyFcYpzTnP6JgJow7KtFn7KbRymEfq5L2uqvEvq9cS has been greeted 1 time(s)
Success
</span></span></span></span></code></pre><p>Run npm start again and you’ll see the times we say hello increases by 1 each time. Ever seen a hello world tutorial longer this before?</p><h3>Conclusion</h3><p>Congrats! We just created a solana program, deployed it on a local cluster, and interacted with it from the client side using a JSON RPC API.<br>You can use this tutorial as a reference on various Solana and Rust concepts as you build your own programs.</p>
        </div>

         <footer>
            <p>Copyright © 2023 🚀 Kelvin Kirima.</p>
        </footer>

    </body>
</html>